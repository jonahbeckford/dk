{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "id": "https://json.schemastore.org/mlfront-values.json",
    "title": "JSON schema for values.json, values.json, *.values.json and *.values.jsonc build files",
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "$schema": {
            "description": "The JSON schema for MlFront values.json, values.json, *.values.json and *.values.jsonc. Used by VS Code for auto-completions, but otherwise ignored.",
            "type": "string",
            "default": "https://github.com/diskuv/dk/raw/refs/heads/V2_4/etc/jsonschema/mlfront-values.json"
        },
        "schema_version": {
            "type": "object",
            "additionalProperties": false,
            "description": "The version of the value specification that these values conform to.",
            "properties": {
                "major": {
                    "type": "integer",
                    "enum": [
                        1
                    ]
                },
                "minor": {
                    "type": "integer",
                    "enum": [
                        0
                    ]
                }
            },
            "required": [
                "major",
                "minor"
            ]
        },
        "forms": {
            "description": "The forms defined in this values document",
            "type": "array",
            "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "id": {
                        "description": "The identifier for the form, in the format 'PACKAGE.NAME@VERSION'. It must be unique across the value store. The PACKAGE is optional if the build system supplies an implicit package, but best practice is to supply it. The VERSION must be a semver 2.0.0 compatible version number as documented by https://semver.org/. Any 'bn-*' semver build metadata will be dropped. Any 'dk-*' metadata is reserved for the build system. The form may be called from a MlFront script using the function call '<PACKAGE.NAME>.form ()'.",
                        "type": "string"
                    },
                    "precommands": {
                        "description": "The commands used to fetch objects that must be available to execute the form. The commands are written in the Value Shell Language (VSL). For example, 'get-object VGKot5hBsd81kMupNCXHaqbhv3huEbxAFMLnpcX2hniwn File.Agnostic > gcc'.",
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                            "private": {
                                "description": "The commands used to fetch objects that must be available to execute the form. The commands are written in the Value Shell Language (VSL). When installing the form with an installer value controller, these \"private\" objects are not installed with this form's output.",
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            },
                            "public": {
                                "description": "The commands used to fetch objects that must be available to execute the form. The commands are written in the Value Shell Language (VSL). When installing the form with an installer value controller, these \"public\" objects are installed with this form's output. Any \"public\" objects of the \"public\" form objects are installed transitively.",
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "function": {
                        "description": "The command line invocation that will execute the form. If no .function is specified, the \"identity\" function which does nothing will be used instead; the identity function is useful when combined with one or more .assets that are redirected in .objects to the out/ folder.",
                        "type": "object",
                        "additionalProperties": false,
                        "properties": {
                            "args": {
                                "description": "The command line arguments to the executable. All form variables (ex. ${SLOT.File.Agnostic}) may be used.",
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "envmods": {
                                "description": "Environment variables supplied to the executable",
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            },
                            "execution": {
                                "description": "Technical requirements for the machine that will execute the function. The OSFamily and ISA from Bazel's Platform Lexicon (https://github.com/bazelbuild/remote-apis/blob/main/build/bazel/remote/execution/v2/platform.md) may be supported by the build system.",
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "additionalProperties": false,
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "value": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        },
                        "required": [
                            "args"
                        ]
                    },
                    "outputs": {
                        "type": "object",
                        "properties": {
                            "files": {
                                "description": "These files will be assigned and validated as output after the form executable is finished running.",
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "description": "A set of output files produced by the form where all of the given [slots] will produce all of the given relative file [paths]. The file paths are relative to the object slot ${SLOT.name}. The object slot is a namespace that may be used to refer to the file from other thunks.",
                                    "properties": {
                                        "slots": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "description": "The object slot that the file is placed in. The object slot is a namespace that may be used to refer to the file in other thunks."
                                            },
                                            "minItems": 1
                                        },
                                        "paths": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "description": "The file path relative to the object slot."
                                            },
                                            "minItems": 1
                                        }
                                    },
                                    "additionalProperties": false,
                                    "required": [
                                        "slots",
                                        "paths"
                                    ]
                                },
                                "minItems": 1
                            }
                        }
                    }
                },
                "required": [
                    "id",
                    "outputs"
                ]
            }
        },
        "assets": {
            "description": "The assets, possibly remote, defined in this values document. The assets are arranged in \"listings\" that follow the specification in https://diskuv.com/dk/help/latest/manual/DkAssets_Capture-Spec-1/.",
            "type": "array",
            "items": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "id": {
                        "description": "The identifier for the asset, in the format 'PACKAGE.NAME@VERSION'. It must be unique across the value store. The VERSION must be a semver 2.0.0 compatible version number as documented by https://semver.org/. Any 'bn-*' semver build metadata will be dropped. Any 'dk-*' metadata is reserved for the build system. The asset may be called from a MlFront script using the function call '<PACKAGE.NAME>.asset ()'.",
                        "type": "string"
                    },
                    "listing_unencrypted": {
                        "description": "Deprecated. The spec_version is ignored since the schema_version field makes it redundant.",
                        "type": "object",
                        "properties": {
                            "spec_version": {
                                "type": "integer",
                                "enum": [
                                    2
                                ]
                            }
                        },
                        "required": [
                            "spec_version"
                        ]
                    },
                    "listing": {
                        "description": "The metadata for the asset that may be encrypted in future versions of the asset spec.",
                        "type": "object",
                        "properties": {
                            "origins": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string",
                                            "description": "A local identifier for the origin used to identify the source of each file in the [files] section. More than one file in [files] can come from the same origin."
                                        },
                                        "mirrors": {
                                            "type": "array",
                                            "description": "The base URL of each source site. The base URL combined with the path in the [files] section become the full URL used to download the asset file when the file is not cached.",
                                            "items": {
                                                "type": "string"
                                            },
                                            "minItems": 1
                                        }
                                    },
                                    "required": [
                                        "name",
                                        "mirrors"
                                    ]
                                }
                            }
                        }
                    },
                    "files": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "origin": {
                                    "type": "string",
                                    "description": "The name of the origin that is the source of the asset file. This field is optional only for canonicalization (comparison purposes); in all other contexts this field is required."
                                },
                                "path": {
                                    "type": "string",
                                    "description": "The relative subpath from the origin's base URL"
                                },
                                "size": {
                                    "type": "integer",
                                    "description": "The file size of the asset file. This field is optional only for canonicalization (comparison purposes); in all other contexts this field is required."
                                },
                                "checksum": {
                                    "type": "object",
                                    "properties": {
                                        "sha256": {
                                            "type": "string",
                                            "description": "The SHA-256 checksum of the asset file, in lowercase hexadecimal."
                                        }
                                    },
                                    "required": [
                                        "sha256"
                                    ]
                                }
                            },
                            "required": [
                                "path",
                                "checksum"
                            ]
                        }
                    }
                }
            }
        }
    },
    "required": [
        "schema_version"
    ]
}